#!/bin/bash
# Fix LOAD_IMM instructions in unit_tests.cpp to use 3-byte format

cd /mnt/e/VirtComp
cp src/test/unit_tests.cpp src/test/unit_tests.cpp.backup

# Replace the 6-byte LOAD_IMM format with 3-byte format
sed -i 's/0x01, 0x00, 0x05, 0x00, 0x00, 0x00,/0x01, 0x00, 0x05,/g' src/test/unit_tests.cpp
sed -i 's/0x01, 0x00, 0x03, 0x00, 0x00, 0x00,/0x01, 0x00, 0x03,/g' src/test/unit_tests.cpp
sed -i 's/0x01, 0x00, 0x0A, 0x00, 0x00, 0x00,/0x01, 0x00, 0x0A,/g' src/test/unit_tests.cpp
sed -i 's/0x01, 0x00, 0x42, 0x00, 0x00, 0x00,/0x01, 0x00, 0x42,/g' src/test/unit_tests.cpp
sed -i 's/0x01, 0x01, 0x03, 0x00, 0x00, 0x00,/0x01, 0x01, 0x03,/g' src/test/unit_tests.cpp
sed -i 's/0x01, 0x01, 0x05, 0x00, 0x00, 0x00,/0x01, 0x01, 0x05,/g' src/test/unit_tests.cpp
sed -i 's/0x01, 0x01, 0x00, 0x00, 0x00, 0x00,/0x01, 0x01, 0x00,/g' src/test/unit_tests.cpp
sed -i 's/0x01, 0x01, 0x84, 0x00, 0x00, 0x00,/0x01, 0x01, 0x84,/g' src/test/unit_tests.cpp
sed -i 's/0x01, 0x01, 0x64, 0x00, 0x00, 0x00,/0x01, 0x01, 0x64,/g' src/test/unit_tests.cpp
sed -i 's/0x01, 0x02, 0x99, 0x00, 0x00, 0x00,/0x01, 0x02, 0x99,/g' src/test/unit_tests.cpp
sed -i 's/0x01, 0x03, 0x77, 0x00, 0x00, 0x00,/0x01, 0x03, 0x77,/g' src/test/unit_tests.cpp

echo "Updated LOAD_IMM instructions to use 3-byte format"
