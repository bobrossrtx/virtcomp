# Decision Log

| Date | Decision | Rationale |
|------|----------|-----------|
| 2025-07-10 | LOAD_IMM instruction uses 3-byte format: opcode + register + immediate_value | All hex test files and the loader use 3-byte format, but unit tests were incorrectly using 6-byte format. Fixed all tests to use consistent 3-byte format which resolved multiple test failures. |
| 2025-07-10 | Carry flag testing requires 32-bit overflow using NOT + ADD technique | Since registers are uint32_t, simple 8-bit overflow (255+1) doesn't trigger carry flag. Solution: Load 0, use NOT to get 0xFFFFFFFF, then ADD 1 to create proper 32-bit overflow that sets carry flag. |
| 2025-07-10 | Critical opcode mapping corrections: CMP=0x0A (not 0x05), IN=0x30, OUT=0x31, JC=0x0F, JNC=0x22 | Found multiple tests using wrong opcodes causing failures and infinite loops. JMP=0x05, but tests were using 0x05 for CMP which caused infinite loops. All opcodes must match the enum in cpu.hpp exactly. |
| 2025-07-10 | Systematic documentation accuracy verification process | Critical to ensure all documentation matches the actual cpu.hpp implementation. Found significant discrepancies between documented opcodes/formats and actual implementation that could mislead users and developers. Established process: 1) Read cpu.hpp for canonical definitions, 2) Search docs for opcode usage, 3) Correct mismatches, 4) Verify logical consistency across all files. |
| 2025-07-10 | Complete documentation opcode accuracy overhaul | Discovered systematic and extensive opcode mapping errors across ALL major documentation files. The documentation was using completely outdated and incorrect opcode mappings that did not match the actual cpu.hpp implementation. This was a critical issue that could have caused major confusion for users and developers. Systematically corrected every single opcode reference across: CONTRIBUTING.md, docs/TROUBLESHOOTING.md, docs/usage/README.md, docs/codebase/API_REFERENCE.md, and main README.md. |
| 2025-07-10 | VirtComp documentation accuracy verification completed successfully | Completed systematic review of ALL documentation files and corrected extensive opcode mapping errors. The documentation is now fully aligned with the cpu.hpp implementation. All instruction formats, code examples, and reference tables are accurate. Test files use appropriate compact binary format for the test framework. The documentation now provides reliable, consistent guidance for VirtComp users and developers. |
